{"version":3,"file":"commonHelpers.js","sources":["../src/js/modalOrder.js","../src/js/activeBasket.js","../src/js/basket.js"],"sourcesContent":["const modalOrder = () => {\n  const refs = {\n    openModalBtn: document.querySelector('[data-modal-open]'),\n    closeModalBtn: document.querySelector('[data-modal-close]'),\n    modal: document.querySelector('[data-modal]'),\n  };\n  refs.openModalBtn.addEventListener('click', openWindow);\n  refs.closeModalBtn.addEventListener('click', closeModal);\n  document.addEventListener('keydown', closeModalOnEsc);\n\n  function openWindow() {\n    refs.modal.classList.toggle('is-hidden');\n    // refs.modal.style.display = 'block';\n    document.body.style.overflow = 'hidden';\n  }\n\n  function closeModal() {\n    refs.modal.classList.toggle('is-hidden');\n    // refs.modal.style.display = 'none';\n    document.body.style.overflow = '';\n  }\n  function closeModalOnEsc(event) {\n    if (event.key === 'Escape' && !refs.modal.classList.contains('is-hidden')) {\n      refs.modal.classList.toggle('is-hidden');\n      document.body.style.overflow = '';\n    }\n  }\n};\n\nexport { modalOrder };\n","import { getProductByID } from './fetchAPI';\nimport { updateItemCountDisplay } from './header';\n\nclass ShoppingCart {\n  constructor() {\n    this.listInBasket = document.querySelector('.list-in-basket');\n    this.totalPriceElement = document.querySelector('.total-price');\n    this.formInput = document.querySelector('.form-input');\n    this.deleteAllButton = document.querySelector('.delete-button');\n    this.cartHeader = document.querySelector('.cart-header');\n    this.form = document.querySelector('.form-container');\n    this.input = document.querySelector('.form-input');\n\n    this.storedProducts = JSON.parse(localStorage.getItem('basket')) || [];\n    this.totalAmountOfElements = this.storedProducts.length;\n\n    //EventListeners\n    this.deleteAllButton.addEventListener('click', this.deleteList.bind(this));\n\n    this.listInBasket.addEventListener(\n      'click',\n      this.handleDeleteClick.bind(this)\n    );\n    this.listInBasket.addEventListener('click', async event => {\n      const decreaseButton = event.target.closest('.btn-minus');\n      if (decreaseButton) {\n        const cardContainer = decreaseButton.closest('.card-container');\n        if (cardContainer) {\n          const productId = cardContainer.getAttribute('data-id');\n          await this.decreaseProductQuantity(productId);\n        }\n      }\n    });\n\n    this.listInBasket.addEventListener('click', async event => {\n      const increaseButton = event.target.closest('.btn-plus');\n      if (increaseButton) {\n        const cardContainer = increaseButton.closest('.card-container');\n        if (cardContainer) {\n          const productId = cardContainer.getAttribute('data-id');\n          await this.increaseProductQuantity(productId);\n        }\n      }\n    });\n\n    this.form.addEventListener('submit', event => {\n      const email = this.input.value;\n\n      const formDataJSON = JSON.stringify(email);\n\n      localStorage.setItem('formData', formDataJSON);\n    });\n  }\n\n  handleDeleteClick(event) {\n    const deleteButton = event.target.closest('.delete-elem-button');\n\n    if (deleteButton) {\n      const productId = deleteButton\n        .closest('.card-container')\n        .getAttribute('data-id');\n\n      const productIndex = this.storedProducts.findIndex(\n        product => product === productId\n      );\n\n      if (productIndex !== -1) {\n        this.storedProducts.splice(productIndex, 1);\n\n        localStorage.setItem('basket', JSON.stringify(this.storedProducts));\n\n        this.totalAmountOfElements = this.storedProducts.length;\n      }\n\n      const listItem = deleteButton.closest('.card-container');\n      if (listItem && listItem.parentNode) {\n        listItem.parentNode.removeChild(listItem);\n      }\n\n      this.updateCartHeader();\n      this.updateTotalPrice();\n      updateItemCountDisplay();\n    }\n  }\n\n  deleteList() {\n    this.cartHeader.textContent = 'CART (0)';\n    this.totalPriceElement.textContent = '$0,00';\n    this.listInBasket.innerHTML = '';\n    localStorage.clear();\n    updateItemCountDisplay();\n  }\n\n  async logProductsApi() {\n    try {\n      for (const id of this.storedProducts) {\n        const result = await getProductByID(id);\n\n        if (result) {\n          result.quantity = 1;\n          const existingListItem = this.listInBasket.querySelector(\n            `[data-id=\"${result._id}\"]`\n          );\n\n          if (existingListItem) {\n            const counterSpan = existingListItem.querySelector('.counter');\n            if (counterSpan) {\n              counterSpan.textContent = result.quantity;\n            }\n          } else {\n            const newCard = this.createProductCard(result);\n            this.listInBasket.insertAdjacentHTML('beforeend', newCard);\n          }\n        } else {\n          console.log(`Product with ID ${id} not found`);\n        }\n      }\n\n      this.updateCartHeader();\n      await this.updateTotalPrice();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  createProductCard(product) {\n    return `\n      <li class=\"card-container\" data-id=\"${product._id}\">\n        <div class=\"image-container\">\n          <img class=\"card-image\" src=\"${product.img}\" alt=\"${product.name}\" />\n        </div>\n        <div class=\"card-description\">\n          <div class=\"description-container\">\n            <div class=\"list-title-container\">\n              <h1 class=\"card-title\">${product.name}</h1>\n              <button class=\"delete-elem-button\" data-id=\"${product._id}\">\n                <svg class=\"delete-elem-icon\">\n                  <use href=\"../img/icons/sprite.svg#icon-close\"></use>\n                </svg>\n              </button>\n            </div>\n            <ul class=\"category-container\">\n              <li>\n                <p class=\"details-text\">\n                  <span class=\"detail\">Category:</span><span>${\n                    product.category\n                  }</span>\n                </p>\n              </li>\n              <li>\n                <p class=\"details-text\">\n                  <span class=\"detail\">Size:</span>${product.size}\n                </p>\n              </li>\n            </ul>\n          </div>\n          <div class=\"price-container\">\n            <span class=\"card-price\">$${product.price}</span>\n            <div class=\"counter-container\">\n              <button class=\"btn-minus\">\n                <svg class=\"counter-icon\">\n                  <use href=\"../img/icons/sprite.svg#icon-down-categories\"></use>\n                </svg>\n              </button>\n              <span class=\"counter\">${product.quantity || 1}</span>\n              <button class=\"btn-plus\">\n                <svg class=\"counter-icon\">\n                  <use href=\"../img/icons/sprite.svg#icon-close\"></use>\n                </svg>\n              </button>\n            </div>\n          </div>\n        </div>\n      </li>\n    `;\n  }\n\n  updateCartHeader() {\n    this.cartHeader.textContent = `CART (${this.totalAmountOfElements})`;\n  }\n\n  async updateTotalPrice() {\n    let totalPrice = 0;\n\n    for (const id of this.storedProducts) {\n      const product = await getProductByID(id);\n\n      if (product) {\n        totalPrice += product.price * (product.quantity || 1);\n      }\n    }\n\n    this.totalPriceElement.textContent = `$${totalPrice.toFixed(2)}`;\n  }\n}\n\nexport { ShoppingCart };\n","// COUNT OF BASKET //\nimport {\n  // addItemButton,\n  // removeItemButton,\n  updateItemCountDisplay,\n  // addItemToLocalArray,\n  // removeItemFromLocalArray,\n} from './header';\n\n// addItemButton.addEventListener('click', function () {\n//   addItemToLocalArray(Math.random());\n// });\n// removeItemButton.addEventListener('click', function () {\n//   removeItemFromLocalArray(0);\n// });\nupdateItemCountDisplay();\n\n////////////////////////////////////////////////////////////////////////////\n\n// MODAL ORDER //\n\nimport { modalOrder } from './modalOrder';\n\nmodalOrder();\n\n////////////////////////////////////////////////////////////////////////////\n\n// SUBSCRIPTION SCRIPT\n\nimport { subscriptionSubmit } from './footer';\n\nconst formOrder = document.querySelector('.form-button');\n\nformOrder.addEventListener('submit', subscriptionSubmit);\n\n////////////////////////////////////////////////////////////////////////////\n\n// MAIN LOGIC OF BASKET\n\nconst emptyBasket = document.querySelector('.emptyBasket_section');\nconst activeBasket = document.querySelector('.active-basket-container');\n\nfunction isBasketActive() {\n  activeBasket.style.display = 'none';\n  let storedArray = localStorage.getItem('basket');\n  if (storedArray) {\n    emptyBasket.style.display = 'none';\n    activeBasket.style.display = '';\n    storedArray = JSON.parse(storedArray);\n  } else {\n    emptyBasket.style.display = '';\n  }\n}\n\nisBasketActive();\n\nimport { ShoppingCart } from './activeBasket';\n\nconst shoppingCart = new ShoppingCart();\n\nshoppingCart.logProductsApi();\n"],"names":["modalOrder","refs","openWindow","closeModal","closeModalOnEsc","event","ShoppingCart","decreaseButton","cardContainer","productId","increaseButton","email","formDataJSON","deleteButton","productIndex","product","listItem","updateItemCountDisplay","id","result","getProductByID","existingListItem","counterSpan","newCard","error","totalPrice","formOrder","subscriptionSubmit","emptyBasket","activeBasket","isBasketActive","storedArray","shoppingCart"],"mappings":"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"}